name: Compilar SA-MP Filterscripts

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    # Passo 1: Fazer checkout do código
    - name: Checkout do repositório
      uses: actions/checkout@v3

    # Passo 2: Instalar Pawn Compiler
    - name: Instalar Pawn Compiler
      run: |
        sudo apt update
        sudo apt install -y pawno

    # Passo 3: Criar pasta de build
    - name: Criar pasta de build
      run: mkdir -p build/filterscripts

    # Passo 4: Compilar todos os filterscripts
    - name: Compilar filterscripts
      run: |
        for file in filterscripts/*.pwn; do
          base=$(basename "$file" .pwn)
          echo "Compilando $file..."
          pawncc "$file" -iqawno/include/YSI_Storage -o build/filterscripts/"$base".amx
        done

    # Opcional: compilar gamemodes se houver
    - name: Compilar gamemodes
      run: |
        mkdir -p build/gamemodes
        for file in gamemodes/*.pwn; do
          base=$(basename "$file" .pwn)
          echo "Compilando $file..."
          pawncc "$file" -iqawno/include/YSI_Storage -o build/gamemodes/"$base".amx
        done
